<?php
	require_once("config.php");
	
	Class DBAccess
	{
		var $link = null;
		
		function DBAccess()
		{
			$this->link = mysql_connect(IP_ADDR,USER_NAME,USER_PASS);

			mysql_select_db(DB_NAME,$this->link);
		}

		function verify_userlogin($user, $pass)
		{
			$sql	= "select * from tbl_user where user='".$user."' AND pass='".$pass."'";

			$result = mysql_query($sql,$this->link);
			$count	= mysql_num_rows($result);
			
			return $count;
		}

		function get_info_arr($table, $order="", $where="1")
		{
			$sql 	= "select * from ".$table." where 1 AND ".$where.$order;

			$result = mysql_query($sql);
			$rows 	= array();

			while($res = mysql_fetch_assoc($result))
			{
				$rows[] = $res;
			}

			return $rows;
		}

		function run_sql($sql)
		{
			mysql_query($sql);

			return mysql_insert_id();
		}

		function table_list($db)
		{
			$rows = array();
			$sql = "SHOW TABLES FROM $db";
			$result = mysql_query($sql);

			while($res = mysql_fetch_array($result))
			{
				$rows[] = $res[0];
			}

			return $rows;
		}

		function get_fields($table)
		{
			$sql 	= "SELECT * FROM $table";
			$result = mysql_query($sql);
			$fields = array();

			while($res = mysql_fetch_field($result))
			{
				$fields[] = $res;
			}			

			return $fields;
		}

		function get_datas($query)
		{
			$sql 	= $query;
			$result = mysql_query($sql);
			$rows   = array();
			while($r = mysql_fetch_assoc($result)) {
			    $rows[] = $r;
			}

			$data   = json_encode($rows);
			return $data;
		}

		function make_tbl_html($list_tbl)
		{
			$html_tbl = "";

			for($i = 0; $i < count($list_tbl); $i ++)
			{
				$html_tbl .= '<dd>';
				$html_tbl .= '<svg class="Icon Icon-table2" width="18" height="18" viewBox="0 0 32 28" fill="currentcolor" name="table2" size="18">';
				$html_tbl .= '<g fill="currentcolor" fill-rule="evenodd">';
				$html_tbl .= '<path d="M10,19 L10,15 L3,15 L3,13 L10,13 L10,9 L12,9 L12,13 L20,13 L20,9 L22,9 L22,13 L29,13 L29,15 L22,15 L22,19 L29,19 L29,21 L22,21 L22,25 L20,25 L20,21 L12,21 L12,25 L10,25 L10,21 L3,21 L3,19 L10,19 L10,19 Z M12,19 L12,15 L20,15 L20,19 L12,19 Z M30.5,0 L32,0 L32,28 L30.5,28 L1.5,28 L0,28 L0,0 L1.5,0 L30.5,0 Z M29,3 L29,25 L3,25 L3,3 L29,3 Z M3,7 L29,7 L29,9 L3,9 L3,7 Z"></path>';
				$html_tbl .= '</g></svg>';
				$html_tbl .= '<info>'.$list_tbl[$i].'</info></dd>';
			}

			return $html_tbl;
		}

		function make_fild_html($list_fld)
		{
			$html_fld = "";

			for($i = 0; $i < count($list_fld); $i ++)
			{
				$icon = '<svg class="Icon Icon-int" width="18" height="18" viewBox="0 0 24, 24" fill="currentcolor" name="int" size="18"><path d="M15.141,15.512 L14.294,20 L13.051,20 C12.8309989,20 12.6403341,19.9120009 12.479,19.736 C12.3176659,19.5599991 12.237,19.343668 12.237,19.087 C12.237,19.0503332 12.2388333,19.0155002 12.2425,18.9825 C12.2461667,18.9494998 12.2516666,18.9146668 12.259,18.878 L12.908,15.512 L10.653,15.512 L10.015,19.01 C9.94899967,19.3620018 9.79866784,19.6149992 9.564,19.769 C9.32933216,19.9230008 9.06900143,20 8.783,20 L7.584,20 L8.42,15.512 L7.155,15.512 C6.92033216,15.512 6.74066729,15.4551672 6.616,15.3415 C6.49133271,15.2278328 6.429,15.0390013 6.429,14.775 C6.429,14.6723328 6.43999989,14.5550007 6.462,14.423 L6.605,13.554 L8.695,13.554 L9.267,10.518 L6.913,10.518 L7.122,9.385 C7.17333359,9.10633194 7.28699912,8.89916734 7.463,8.7635 C7.63900088,8.62783266 7.92499802,8.56 8.321,8.56 L9.542,8.56 L10.224,5.018 C10.282667,4.7246652 10.4183323,4.49733414 10.631,4.336 C10.8436677,4.17466586 11.0929986,4.094 11.379,4.094 L12.611,4.094 L11.775,8.56 L14.019,8.56 L14.866,4.094 L16.076,4.094 C16.3326679,4.094 16.5416659,4.1673326 16.703,4.314 C16.8643341,4.4606674 16.945,4.64766553 16.945,4.875 C16.945,4.9483337 16.9413334,5.00333315 16.934,5.04 L16.252,8.56 L18.485,8.56 L18.276,9.693 C18.2246664,9.97166806 18.1091676,10.1788327 17.9295,10.3145 C17.7498324,10.4501673 17.4656686,10.518 17.077,10.518 L15.977,10.518 L15.416,13.554 L16.978,13.554 C17.2126678,13.554 17.3904994,13.6108328 17.5115,13.7245 C17.6325006,13.8381672 17.693,14.0306653 17.693,14.302 C17.693,14.4046672 17.6820001,14.5219993 17.66,14.654 L17.528,15.512 L15.141,15.512 Z M10.928,13.554 L13.183,13.554 L13.744,10.518 L11.5,10.518 L10.928,13.554 Z"></path></svg>';

				switch ($list_fld[$i]->type) 
				{
					case 'date':
					case 'timestamp':
						$html_fld .= "<dd info='date'>";
						$icon = '<svg class="Icon Icon-calendar" width="18" height="18" viewBox="0 0 24 24" fill="currentcolor" name="calendar" size="18"><path d="M21,2 L21,0 L18,0 L18,2 L6,2 L6,0 L3,0 L3,2 L2.99109042,2 C1.34177063,2 0,3.34314575 0,5 L0,6.99502651 L0,20.009947 C0,22.2157067 1.78640758,24 3.99005301,24 L20.009947,24 C22.2157067,24 24,22.2135924 24,20.009947 L24,6.99502651 L24,5 C24,3.34651712 22.6608432,2 21.0089096,2 L21,2 L21,2 Z M22,8 L22,20.009947 C22,21.1099173 21.1102431,22 20.009947,22 L3.99005301,22 C2.89008272,22 2,21.1102431 2,20.009947 L2,8 L22,8 L22,8 Z M6,12 L10,12 L10,16 L6,16 L6,12 Z"></path></svg>';
					break;
					
					case 'string' :
					case 'blob' :
						$html_fld .= "<dd info='string'>";
						$icon = '<svg class="Icon Icon-string" width="18" height="18" viewBox="0 0 24 24" fill="currentcolor" name="string" size="18"><path d="M14.022,18 L11.533,18 C11.2543319,18 11.0247509,17.935084 10.84425,17.80525 C10.6637491,17.675416 10.538667,17.5091677 10.469,17.3065 L9.652,14.8935 L4.389,14.8935 L3.572,17.3065 C3.50866635,17.4838342 3.38516758,17.6437493 3.2015,17.78625 C3.01783241,17.9287507 2.79300133,18 2.527,18 L0.019,18 L5.377,4.1585 L8.664,4.1585 L14.022,18 Z M5.13,12.7085 L8.911,12.7085 L7.638,8.918 C7.55566626,8.67733213 7.45908389,8.3939183 7.34825,8.06775 C7.23741611,7.7415817 7.12816721,7.3885019 7.0205,7.0085 C6.91916616,7.39483527 6.8146672,7.75266502 6.707,8.082 C6.5993328,8.41133498 6.49800047,8.69633213 6.403,8.937 L5.13,12.7085 Z M21.945,18 C21.6663319,18 21.4557507,17.9620004 21.31325,17.886 C21.1707493,17.8099996 21.0520005,17.6516679 20.957,17.411 L20.748,16.8695 C20.5009988,17.078501 20.2635011,17.2621659 20.0355,17.4205 C19.8074989,17.5788341 19.5715846,17.7134161 19.32775,17.82425 C19.0839154,17.9350839 18.8242514,18.0174164 18.54875,18.07125 C18.2732486,18.1250836 17.9676683,18.152 17.632,18.152 C17.1823311,18.152 16.7738352,18.0934173 16.4065,17.97625 C16.0391648,17.8590827 15.7272513,17.6865011 15.47075,17.4585 C15.2142487,17.2304989 15.016334,16.947085 14.877,16.60825 C14.737666,16.269415 14.668,15.8783355 14.668,15.435 C14.668,15.0866649 14.7566658,14.7288352 14.934,14.3615 C15.1113342,13.9941648 15.4184978,13.6600848 15.8555,13.35925 C16.2925022,13.0584152 16.8814963,12.8066677 17.6225,12.604 C18.3635037,12.4013323 19.297661,12.2873335 20.425,12.262 L20.425,11.844 C20.425,11.2676638 20.3062512,10.8512513 20.06875,10.59475 C19.8312488,10.3382487 19.4940022,10.21 19.057,10.21 C18.7086649,10.21 18.4236678,10.2479996 18.202,10.324 C17.9803322,10.4000004 17.7824175,10.4854995 17.60825,10.5805 C17.4340825,10.6755005 17.2646675,10.7609996 17.1,10.837 C16.9353325,10.9130004 16.7390011,10.951 16.511,10.951 C16.3083323,10.951 16.1357507,10.9019172 15.99325,10.80375 C15.8507493,10.7055828 15.7383337,10.5836674 15.656,10.438 L15.124,9.5165 C15.7193363,8.99083071 16.3795797,8.59975128 17.10475,8.34325 C17.8299203,8.08674872 18.6073292,7.9585 19.437,7.9585 C20.0323363,7.9585 20.5690809,8.05508237 21.04725,8.24825 C21.5254191,8.44141763 21.9307483,8.71058161 22.26325,9.05575 C22.5957517,9.40091839 22.8506658,9.81099763 23.028,10.286 C23.2053342,10.7610024 23.294,11.2803305 23.294,11.844 L23.294,18 L21.945,18 Z M18.563,16.2045 C18.9430019,16.2045 19.2754986,16.1380007 19.5605,16.005 C19.8455014,15.8719993 20.1336652,15.6566682 20.425,15.359 L20.425,13.991 C19.8359971,14.0163335 19.3515019,14.0669996 18.9715,14.143 C18.5914981,14.2190004 18.2906678,14.3139994 18.069,14.428 C17.8473322,14.5420006 17.6937504,14.6718326 17.60825,14.8175 C17.5227496,14.9631674 17.48,15.1214991 17.48,15.2925 C17.48,15.6281683 17.5718324,15.8640827 17.7555,16.00025 C17.9391676,16.1364173 18.2083316,16.2045 18.563,16.2045 L18.563,16.2045 Z"></path></svg>';
					break;

					default : 
						$html_fld .= "<dd info='int'>";
					break;
				}

				$html_fld .= $icon;
				$html_fld .= "<info>".$list_fld[$i]->name."</info>";
				$html_fld .= "</dd>";
			}

			return $html_fld;
		}
	}
?>
